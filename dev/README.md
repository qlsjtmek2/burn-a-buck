# Dev Docs 패턴

Claude Code 세션 및 컨텍스트 리셋 전반에 걸쳐 프로젝트 컨텍스트를 유지하기 위한 방법론입니다.

---

## 문제점

**컨텍스트 리셋은 모든 것을 잃어버립니다:**
- 구현 결정사항
- 주요 파일들과 그 목적
- 작업 진행 상황
- 기술적 제약사항
- 특정 접근 방식을 선택한 이유

**리셋 후, Claude는 모든 것을 다시 찾아야 합니다.**

---

## 해결책: 영구적인 Dev Docs

작업을 재개하는 데 필요한 모든 것을 담은 3개 파일 구조:

```
dev/active/[작업-이름]/
├── [작업-이름]-plan.md      # 전략적 계획
├── [작업-이름]-context.md   # 주요 결정사항 및 파일
└── [작업-이름]-tasks.md     # 체크리스트 형식
```

**이 파일들은 컨텍스트 리셋 후에도 남습니다** - Claude가 이를 읽고 즉시 작업을 재개할 수 있습니다.

---

## 3개 파일 구조

### 1. [작업-이름]-plan.md

**목적:** 구현을 위한 전략적 계획

**포함 내용:**
- 요약
- 현재 상태 분석
- 제안하는 미래 상태
- 구현 단계
- 승인 기준이 포함된 세부 작업
- 리스크 평가
- 성공 지표
- 타임라인 추정

**생성 시점:** 복잡한 작업을 시작할 때

**업데이트 시점:** 범위가 변경되거나 새로운 단계가 발견될 때

**예시:**
```markdown
# 기능 이름 - 구현 계획

## 요약
무엇을 만들고 왜 만드는지

## 현재 상태
현재 위치

## 구현 단계

### 단계 1: 인프라 (2시간)
- 작업 1.1: 데이터베이스 스키마 설정
  - 승인 조건: 스키마 컴파일 성공, 관계 정확
- 작업 1.2: 서비스 구조 생성
  - 승인 조건: 모든 디렉토리 생성됨

### 단계 2: 핵심 기능 (3시간)
...
```

---

### 2. [작업-이름]-context.md

**목적:** 작업 재개를 위한 핵심 정보

**포함 내용:**
- SESSION PROGRESS 섹션 (자주 업데이트!)
- 완료된 작업 vs 진행 중 작업
- 주요 파일과 그 목적
- 내린 중요한 결정
- 발견한 기술적 제약사항
- 관련 파일 링크
- 빠른 재개 지침

**생성 시점:** 작업 시작 시

**업데이트 시점:** **자주** - 주요 결정, 완료, 발견 후마다

**예시:**
```markdown
# 기능 이름 - 컨텍스트

## SESSION PROGRESS (2025-10-29)

### ✅ 완료
- 데이터베이스 스키마 생성 (User, Post, Comment 모델)
- BaseController 패턴으로 PostController 구현
- Sentry 통합 완료

### 🟡 진행 중
- 비즈니스 로직이 포함된 PostService 생성 중
- 파일: src/services/postService.ts

### ⚠️ 블로커
- 캐싱 전략 결정 필요

## 주요 파일

**src/controllers/PostController.ts**
- BaseController 확장
- 게시물에 대한 HTTP 요청 처리
- PostService에 위임

**src/services/postService.ts** (진행 중)
- 게시물 작업을 위한 비즈니스 로직
- 다음: 캐싱 추가

## 빠른 재개
계속하려면:
1. 이 파일 읽기
2. PostService.createPost() 구현 계속
3. 남은 작업은 tasks 파일 참조
```

**중요:** 중요한 작업이 완료될 때마다 SESSION PROGRESS 섹션을 업데이트하세요!

---

### 3. [작업-이름]-tasks.md

**목적:** 진행 상황 추적을 위한 체크리스트

**포함 내용:**
- 논리적 섹션별로 구분된 단계
- 체크박스 형식의 작업
- 상태 표시자 (✅/🟡/⏳)
- 승인 기준
- 빠른 재개 섹션

**생성 시점:** 작업 시작 시

**업데이트 시점:** 각 작업 완료 후 또는 새 작업 발견 시

**예시:**
```markdown
# 기능 이름 - 작업 체크리스트

## 단계 1: 설정 ✅ 완료
- [x] 데이터베이스 스키마 생성
- [x] 컨트롤러 설정
- [x] Sentry 설정

## 단계 2: 구현 🟡 진행 중
- [x] PostController 생성
- [ ] PostService 생성 (진행 중)
- [ ] PostRepository 생성
- [ ] Zod로 검증 추가

## 단계 3: 테스트 ⏳ 시작 안 됨
- [ ] 서비스 단위 테스트
- [ ] 통합 테스트
- [ ] 수동 API 테스트
```

---

## Dev Docs 사용 시기

**다음 경우에 사용:**
- ✅ 여러 날에 걸친 복잡한 작업
- ✅ 여러 요소가 있는 기능
- ✅ 여러 세션에 걸칠 가능성이 있는 작업
- ✅ 신중한 계획이 필요한 작업
- ✅ 대규모 시스템 리팩토링

**생략할 경우:**
- ❌ 간단한 버그 수정
- ❌ 단일 파일 변경
- ❌ 빠른 업데이트
- ❌ 사소한 수정

**경험 법칙:** 2시간 이상 걸리거나 여러 세션에 걸치는 작업이라면 dev docs를 사용하세요.

---

## Dev Docs를 사용한 워크플로우

### 새 작업 시작

1. **/dev-docs 슬래시 명령어 사용:**
   ```
   /dev-docs 인증 시스템 리팩토링
   ```

2. **Claude가 3개 파일 생성:**
   - 요구사항 분석
   - 코드베이스 검사
   - 종합 계획 생성
   - 컨텍스트 및 작업 파일 생성

3. **검토 및 조정:**
   - 계획이 합리적인지 확인
   - 누락된 고려사항 추가
   - 타임라인 추정 조정

### 구현 중

1. 전체 전략을 위해 **plan 참조**
2. **context.md를 자주 업데이트:**
   - 완료된 작업 표시
   - 내린 결정 기록
   - 블로커 추가
3. 작업 완료 시 **tasks.md에서 체크**

### 컨텍스트 리셋 후

1. **Claude가 3개 파일 모두 읽음**
2. 몇 초 만에 **완전한 상태 이해**
3. **정확히 중단한 지점부터 재개**

무엇을 하고 있었는지 설명할 필요 없음 - 모두 문서화되어 있습니다!

---

## 슬래시 명령어와의 통합

### /dev-docs
**생성:** 작업을 위한 새 dev docs

**사용법:**
```
/dev-docs 실시간 알림 구현
```

**생성 내용:**
- `dev/active/implement-real-time-notifications/`
  - implement-real-time-notifications-plan.md
  - implement-real-time-notifications-context.md
  - implement-real-time-notifications-tasks.md

### /dev-docs-update
**업데이트:** 컨텍스트 리셋 전 기존 dev docs 업데이트

**사용법:**
```
/dev-docs-update
```

**업데이트 내용:**
- 완료된 작업 표시
- 발견한 새 작업 추가
- 세션 진행 상황으로 컨텍스트 업데이트
- 현재 상태 캡처

**사용 시점:** 컨텍스트 한계에 다다르거나 세션 종료 시

---

## 파일 구조

```
dev/
├── README.md              # 이 파일
├── active/                # 현재 작업
│   ├── task-1/
│   │   ├── task-1-plan.md
│   │   ├── task-1-context.md
│   │   └── task-1-tasks.md
│   └── task-2/
│       └── ...
└── archive/               # 완료된 작업 (선택사항)
    └── old-task/
        └── ...
```

**active/**: 진행 중인 작업
**archive/**: 완료된 작업 (참조용)

---

## 예시: 실제 사용

이 저장소의 **dev/active/public-infrastructure-repo/**에서 실제 예시를 확인하세요:
- **plan.md** - 이 쇼케이스 생성을 위한 700줄 이상의 전략적 계획
- **context.md** - 완료된 작업, 내린 결정, 다음 작업 추적
- **tasks.md** - 모든 단계와 작업의 체크리스트

이것은 이 쇼케이스를 만드는 데 사용된 실제 dev docs입니다!

---

## 베스트 프랙티스

### 컨텍스트를 자주 업데이트

**나쁨:** 세션 종료 시에만 업데이트
**좋음:** 각 주요 마일스톤 후 업데이트

**SESSION PROGRESS 섹션은 항상 현실을 반영해야 합니다:**
```markdown
## SESSION PROGRESS (YYYY-MM-DD)

### ✅ 완료 (완료한 모든 것 나열)
### 🟡 진행 중 (바로 지금 작업 중인 것)
### ⚠️ 블로커 (진행을 방해하는 것)
```

### 작업을 실행 가능하게 만들기

**나쁨:** "인증 수정"
**좋음:** "AuthMiddleware.ts에서 JWT 토큰 검증 구현 (승인 조건: 토큰 검증됨, Sentry에 오류 전송)"

**포함 사항:**
- 구체적인 파일 이름
- 명확한 승인 기준
- 다른 작업과의 의존성

### 계획을 최신 상태로 유지

범위가 변경되면:
- 계획 업데이트
- 새 단계 추가
- 타임라인 추정 조정
- 범위 변경 이유 기록

---

## Claude Code를 위한 지침

**사용자가 dev docs 생성을 요청할 때:**

1. **가능하면 /dev-docs 슬래시 명령어 사용**
2. **또는 수동으로 생성:**
   - 작업 범위 질문
   - 관련 코드베이스 파일 분석
   - 종합 계획 생성
   - 컨텍스트 및 작업 생성

3. **다음 내용으로 계획 구성:**
   - 명확한 단계
   - 실행 가능한 작업
   - 승인 기준
   - 리스크 평가

4. **컨텍스트 파일을 재개 가능하게 만들기:**
   - 맨 위에 SESSION PROGRESS
   - 빠른 재개 지침
   - 설명이 포함된 주요 파일 목록

**dev docs에서 재개할 때:**

1. **3개 파일 모두 읽기** (plan, context, tasks)
2. **context.md부터 시작** - 현재 상태 확인
3. **tasks.md 확인** - 완료된 작업과 다음 작업 확인
4. **plan.md 참조** - 전체 전략 이해

**자주 업데이트:**
- 작업 완료 즉시 표시
- 중요한 작업 후 SESSION PROGRESS 업데이트
- 발견한 새 작업 추가

---

## Dev Docs 수동 생성

/dev-docs 명령어가 없는 경우:

**1. 디렉토리 생성:**
```bash
mkdir -p dev/active/your-task-name
```

**2. plan.md 생성:**
- 요약
- 구현 단계
- 세부 작업
- 타임라인 추정

**3. context.md 생성:**
- SESSION PROGRESS 섹션
- 주요 파일
- 중요한 결정
- 빠른 재개 지침

**4. tasks.md 생성:**
- 체크박스가 있는 단계
- [ ] 작업 형식
- 승인 기준

---

## 장점

**dev docs 사용 전:**
- 컨텍스트 리셋 = 처음부터 다시 시작
- 왜 그런 결정을 했는지 잊음
- 진행 상황 추적 불가
- 작업 반복

**dev docs 사용 후:**
- 컨텍스트 리셋 = 3개 파일 읽고, 즉시 재개
- 결정사항 문서화
- 진행 상황 추적
- 작업 반복 없음

**절약 시간:** 컨텍스트 리셋당 몇 시간

---

## 다음 단계

1. 다음 복잡한 작업에서 **패턴 시도**
2. **가능하면 /dev-docs** 슬래시 명령어 사용
3. **자주 업데이트** - 특히 context.md
4. **실제 사용 확인** - dev/active/public-infrastructure-repo/ 둘러보기

**궁금한 점?** [CLAUDE_INTEGRATION_GUIDE.md](../CLAUDE_INTEGRATION_GUIDE.md) 참조
